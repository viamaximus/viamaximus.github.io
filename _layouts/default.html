<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  <!-- base styles -->
  <link rel="stylesheet" href="{{ '/assets/css/atom-one-light.css' | relative_url }}">

  {% if page.title or page.title == 'me' %}
    <title>{{ page.title }}</title>
    <link rel="stylesheet" href="{{ '/assets/css/002.css' | relative_url }}">
  {% else %}
    <title>{{ site.title }}</title>
    <link rel="stylesheet" href="{{ '/assets/css/001.css' | relative_url }}">
  {% endif %}

  <link rel="stylesheet" href="{{ '/assets/css/font-awesome.min.css' | relative_url }}">
  <link rel="icon" href="{{ '/assets/img/favicon.ico' | relative_url }}" type="image/x-icon">
  <link rel="shortcut icon" href="{{ '/assets/img/favicon.ico' | relative_url }}" type="image/x-icon">

  <link rel="stylesheet" href="{{ '/assets/css/windows.css' | relative_url }}?v={{ site.time | date: '%s' }}">


  <!-- force light as default before dark overrides load -->
  <script>
    (function () {
      try {
        var saved = localStorage.getItem('w95-theme');
        if (saved === 'dark') {
          document.documentElement.classList.add('theme-dark');
        } else {
          document.documentElement.classList.remove('theme-dark');
        }
      } catch (e) {
        document.documentElement.classList.remove('theme-dark');
      }
    })();
  </script>

  <!-- optional dark theme overrides (only apply when .theme-dark is present) -->
  <link rel="stylesheet" href="{{ '/assets/css/dark.css' | relative_url }}">

  <!-- taskbar styles -->
  <link rel="stylesheet" href="{{ '/assets/css/taskbar.css' | relative_url }}">

  <!-- syntax highlight -->
  <script src="{{ '/assets/js/highlight.pack.js' | relative_url }}"></script>
  <script>try{hljs.highlightAll();}catch(e){}</script>
</head>
<body>
  <div class="wrapper" id="explorer">
    <div class="default_title">
      <img src="{{ '/assets/img/mycomputer.png' | relative_url }}" />
      {% if page.tag %}
        <h1>{{ page.tag }}</h1>
      {% else %}
        <h1>{{ site.title }}</h1>
      {% endif %}
    </div>

    {% include topbar.html %}

    <!-- left tree of tags -->
    <div class="tag_list">
      <ul id="tag-list">
        <li>
          <a href="{{ '/' | relative_url }}">
            <img src="{{ '/assets/img/disk.png' | relative_url }}" />(C:)
          </a>
          <ul>
            {% assign tags = site.tags | sort %}
            {% for tag in tags %}
              <li>
                <a class="tag-link"
                   data-tag="{{ tag | first | slugify }}"
                   href="{{ '/tag/' | append: tag | first | slugify | append: '/' | relative_url }}">
                  <img src="{{ '/assets/img/folder.ico' | relative_url }}" />{{ tag[0] | replace:'-', ' ' }}
                </a>
              </li>
            {% endfor %}
          </ul>
        </li>
      </ul>
    </div>

    <!-- right pane list/content -->
    <div class="post_list">
      {% if page.url == '/' %}
        <ul>
          {% for post in site.posts %}
            <li class="post-item" data-tags="{{ post.tags | join: ' ' | downcase }}">
              <a href="{{ post.url | relative_url }}">
                <img src="{{ '/assets/img/file.ico' | relative_url }}" />{{ post.title }}
              </a>
            </li>
          {% endfor %}
        </ul>

      {% elsif page.title == 'me' or page.title == '404...' %}
        {{ content }}

      {% elsif page.date %}
        <ul>
          {% for post in site.posts %}
            <li class="post-item" data-tags="{{ post.tags | join: ' ' | downcase }}">
              <a href="{{ post.url | relative_url }}">
                <img src="{{ '/assets/img/file.ico' | relative_url }}" />{{ post.title }}
              </a>
            </li>
          {% endfor %}
        </ul>

      {% else %}
        {{ content }}
      {% endif %}
    </div>

    <div class="post_total">
      {% if page.tag %}
        <div class="left">{{ site.tags[page.tag] | size }} object(s)</div>
      {% else %}
        <div class="left">{{ site.posts | size }} object(s)</div>
      {% endif %}
      <div class="right">&nbsp;</div>
    </div>
  </div>

  {% if page.title %}
    <div class="content" id="content-window">
      <div class="post_title">
        <img src="{{ '/assets/img/file.ico' | relative_url }}" />
        <h1>{{ page.title }}</h1>

        <a href="{{ '/' | relative_url }}">
          <div class="btn" title="close"><span class="fa fa-times"></span></div>
        </a>

        <div class="btn btn_max" id="btn-max" aria-pressed="false" title="maximize"><span class="fa fa-window-maximize"></span></div>
        <div class="btn btn_min" id="btn-min" aria-pressed="false" title="minimize"><span class="fa fa-window-minimize"></span></div>
      </div>

      <ul class="topbar">
        <li>{{ page.date | date: '%B %-d, %Y' }}</li>
      </ul>

      <div class="post_content">
        {{ content }}
      </div>
    </div>
  {% endif %}

  <!-- theme js -->
  <script src="{{ '/assets/js/001.js' | relative_url }}"></script>
  <script src="{{ '/assets/js/002.js' | relative_url }}"></script>

  <!-- append theme toggle button -->
  <script>
    (function () {
      var bar = document.querySelector('.topbar');
      if (!bar || document.getElementById('theme-toggle')) return;

      var li = document.createElement('li');
      li.id = 'theme-toggle';
      li.style.cursor = 'pointer';
      li.title = 'toggle dark mode';
      li.innerHTML = '<span class="fa fa-adjust"></span>&nbsp;Dark';
      bar.appendChild(li);
    })();
  </script>

  <!-- dark toggle logic -->
  <script src="{{ '/assets/js/theme-toggle.js' | relative_url }}"></script>

  <!-- live tag filter (filters right pane and syncs /tag/<slug>/) -->
  <script src="{{ '/assets/js/tag-filter.js' | relative_url }}"></script>

  <!-- small posts index for dos 'dir' command -->
  <script>
    window.__W95_POSTS__ = [
      {% for post in site.posts limit:100 %}
        { "title": {{ post.title | jsonify }}, "path": "{{ post.url | relative_url }}", "date": "{{ post.date | date: '%Y-%m-%d' }}" }{% unless forloop.last %},{% endunless %}
      {% endfor %}
    ];
  </script>

  <!-- taskbar + start menu + dos prompt -->
  {% include taskbar.html %}
  <script src="{{ '/assets/js/start-menu.js' | relative_url }}"></script>
  <script src="{{ '/assets/js/dos.js' | relative_url }}"></script>

  <script>
  // quick probe to verify the button exists and script ran
  (function(){
    var btn = document.getElementById('start-btn');
    console.log('start-btn present:', !!btn);
    btn && btn.addEventListener('click', function(){ console.log('start clicked'); });
  })();
</script>

<script src="{{ '/assets/js/task-programs.js' | relative_url }}"></script>
<script src="{{ '/assets/js/window-manager.js' | relative_url }}"></script>



  <div class="footer">
    <p>Â© {{ site.time | date: "%Y" }} {{ site.title }}. theme adapted from windows-95. code on
      <a href="https://github.com/viamaximus" target="_blank">github</a>.
    </p>
  </div>
</body>
</html>

